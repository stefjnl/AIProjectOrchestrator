@page "/projects/create"

<PageTitle>Create Project</PageTitle>

<h1>Create New Project</h1>

<EditForm Model="@project" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="mb-3">
        <label for="name" class="form-label">Project Name</label>
        <InputText id="name" class="form-control" @bind-Value="project.Name" />
    </div>

    <div class="mb-3">
        <label for="description" class="form-label">Description</label>
        <textarea id="description" class="form-control" @bind="project.Description"></textarea>
    </div>

    <div class="mb-3">
        <button type="submit" class="btn btn-primary">Create Project</button>
        <button type="button" class="btn btn-secondary ms-2" @onclick="Cancel">Cancel</button>
    </div>
</EditForm>

@code {
    private Project project = new();

    private async Task HandleValidSubmit()
    {
        try
        {
            var createdProject = await APIClient.CreateProjectAsync(project);
            Navigation.NavigateTo($"/projects/{createdProject.Id}");
        }
        catch (Exception ex)
        {
            // Handle error
            Console.WriteLine($"Error creating project: {ex.Message}");
        }
    }

    private void Cancel()
    {
        Navigation.NavigateTo("/projects");
    }

    [Inject]
    private IAPIClient APIClient { get; set; } = default!;

    [Inject]
    private NavigationManager Navigation { get; set; } = default!;
}